INCLUDE(ExternalProject)

SET(GLFW_TRIGGER_CONTENT "
	CMAKE_MINIMUM_REQUIRED(VERSION 3.10)
	INCLUDE(ExternalProject)
	PROJECT(GLFWDownloader)
	SET(GLFW_URL https://github.com/glfw/glfw/archive/3.3.tar.gz)
	SET(GLFW_URL_MD5 5be03812f5d109817e6558c3fab7bbe1)
	ExternalProject_Add(
		GLFW
		PREFIX \"${PROJECT_SOURCE_DIR}/lib/glfw/\"
		URL \"\${GLFW_URL}\"
		URL_MD5 \"\${GLFW_URL_MD5}\"
		UPDATE_COMMAND	  \"\"
		CONFIGURE_COMMAND \"\"
		BUILD_COMMAND	  \"\"
		INSTALL_COMMAND	  \"\"
	)
	ADD_CUSTOM_TARGET(GLFWTrigger)
	ADD_DEPENDENCIES(GLFWTrigger GLFW)
")

FILE(MAKE_DIRECTORY "${CMAKE_BINARY_DIR}/GLFWTrigger" "${CMAKE_BINARY_DIR}/GLFWTrigger/build")
FILE(WRITE "${CMAKE_BINARY_DIR}/GLFWTrigger/CMakeLists.txt" "${GLFW_TRIGGER_CONTENT}")
EXECUTE_PROCESS(COMMAND ${CMAKE_COMMAND} .. WORKING_DIRECTORY ${CMAKE_BINARY_DIR}/GLFWTrigger/build)
EXECUTE_PROCESS(COMMAND ${CMAKE_COMMAND} --build . WORKING_DIRECTORY ${CMAKE_BINARY_DIR}/GLFWTrigger/build)

SET(GLFW_BUILD_DOCS OFF CACHE BOOL "" FORCE)
SET(GLFW_BUILD_EXAMPLES OFF CACHE BOOL "" FORCE)
SET(GLFW_BUILD_TESTS OFF CACHE BOOL "" FORCE)
SET(GLFW_INSTALL OFF CACHE BOOL "" FORCE)
ADD_SUBDIRECTORY(lib/glfw/src/GLFW)